from pwn import *
from itertools import cycle

context.os = 'windows'
context.arch = 'i386'


obfuscated = '\x70\xAE\xC9\x9B\x3C\x16\x65\x25\xAE\x68\x2D\xAE\xE4\xD3\xC4\x27\xE1\xAF\xFD\xAF\x23\xD3\xC6\x27\xE1\x25\x20\x1C\x16\x65\x25\x63\x6C\x50\xCD\xEC\xE7\x21\x25\x70\xAE\xC9\xA6\xE1\xD9\xE3\x20\x1C\x16\x65\x25\x25\xDA\x50\x2D\xCD\xE1\xDA\xDA\xDA\x9A\x1F\x16\x65\x25\x9C\x35\x25\x25\x25\xE3\x60\xDA\x25\x85\x1C\x16\x65\x25\x27\xE4\xD3\xC5\x27\xE1\xAF\x78\xDA\xA5\xDE\x24\x59\x22\x01\xD5\xE5\xCD\x21\xCE\x27\x01\x2A\xD3\xFE\xAD\x78\xDA\x19\x2C\x5B\x27\x21\x22\x21\x15\xAD\x22\x62\x63\x6C\x50\xF5\xEC\xC2'

for key in range(0x0, 0xFF+1):
	key = chr(key)
	deobfuscated = ''.join([ chr(ord(a) ^ ord(b)) for (a, b) in zip(obfuscated, cycle(key)) ])
	print '------------------------\n'
	print ord(key)
	print '\n'
	print disasm(deobfuscated)
	print '\n'
	print '------------------------\n\n'
