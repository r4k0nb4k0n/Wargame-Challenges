u_short Malware_L03(u_short * data,u_short length) 
{
        register long value;
        u_short i;
        for(i=0;i<(length>>1);i++) // data의 절반만 누적.
                value+=data[i];
        if((length&1)==1) // data[]의 길이가 홀수라면
                value+=(data[i]<<8); // (data[(int)(length / 2) + 1]) * 256을 더한다.
        value=(value&65535)+(value>>16); // value의 전반 8바이트와 후반 8바이트를 더한다.
        return(~value); // value의 보수를 리턴한다.
}