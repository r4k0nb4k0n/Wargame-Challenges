# Malware Analysis Level 01

## Problem
* 다음 파일은 악성코드 소스의 일부분이다. 이것의 공격방법은 무엇인가
* [`Malware_L01.cpp`](./Malware_L01.cpp)

## Background Knowledge
* IPv4 Header
	+ ![](./IPv4-Header.png?raw=true)
	+ [IPv4 - Wikipedia](https://en.wikipedia.org/wiki/IPv4#Header)
	+ [IPv4 헤더 (정보통신기술용어해설)](http://ktword.co.kr/abbr_view.php?m_temp1=1859)
* TCP Header
	+ ![](./TCP-Header.png?raw=true)
	+ [TCP - Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_segment_structure)
* [Denial-of-service Attack - Wikipedia](https://en.wikipedia.org/wiki/Denial-of-service_attack)
	+ 서비스 거부 공격.
	+ [SYN flood - Wikipedia](https://en.wikipedia.org/wiki/SYN_flood)
		+ 서버에 `SYN` 패킷**만** 보내어 연결을 무수히 만들어 놓고 `ACK` 패킷을 보내지 않아 서버의 자원을 고갈시켜 DoS 상태를 만든다.
* `AF_INET`
	+ The `AF_INET` address family is the address family for IPv4.
	+ [AF_INET - Windows drivers | Microsoft Docs](https://docs.microsoft.com/en-us/windows-hardware/drivers/network/af-inet)
	+ [What is the difference between AF_INET and PF_INET in socket programming? - Stack Overflow](https://stackoverflow.com/questions/6729366/what-is-the-difference-between-af-inet-and-pf-inet-in-socket-programming/15020834)
		+ PF - Protocol Family
		+ AF - Address Family
		+ 이론상 차이는 있지만, 실제 값은 차이 없음.
* `htons()`
	+ The `htons()` function translates a short integer from host byte order to network byte order.
	+ [htons() — Translate an unsigned short integer into network byte order](https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.bpxbd00/htons.htm)
	+ [htons() function in socket programing - Stack Overflow](https://stackoverflow.com/questions/19207745/htons-function-in-socket-programing)

## Explanation
* [`Malware_L01_With_Comment.cpp`](./Malware_L01_With_Comment.cpp)
	+ `tcpHeader.th_flag=2;`
		+ `SYN` Flag is set.
	+ `tcpHeader.th_ack=0;`
		+ NO `ACK`. `SYN` ONLY.
* `SYN` 패킷만 보내어 연결을 무한정 생성하여 서버의 자원을 고갈시키고 끝내 서비스 거부 상태를 만든다.
* 해당 공격 기법은 **SYN Flood**.

## Review
* 대학교 2학년 때 배웠던 데이터통신 수업이 도움이 되었다.
* 악성코드 분석은 역공학 말고도 네트워크 등 기초적인 배경지식과 이에 따른 공격 기법들을 알아야 할 수 있겠다는 생각이 들었다.